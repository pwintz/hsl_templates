% For rendering each frame as one page, use 'handout'.
\documentclass[notheorems, aspectratio=169, presentation]{beamer}

% % For presentation mode
% \setbeamertemplate{note page}[plain] % Don't show outline or next slide.
% \setbeameroption{show notes on second screen=right}


% For handout mode
%   \setbeamertemplate{note page}[plain] % Don't show outline or next slide.
%   \setbeameroption{show notes}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% PACKAGES %%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\usepackage{amsmath}
\usepackage{ifthen}
\usepackage{adjustbox}
\usepackage{color}
\usepackage{graphics,graphicx,amssymb}
\usepackage{amsxtra}
\usepackage{amsfonts}
\usepackage{epsfig}
\usepackage{multicol}
\usepackage{tikz}
\usepackage{animate}
% \usepackage{multimedia} % Provides \movie.
\usetikzlibrary{calc}

% \newif\ifdraft
% \draftfalse
\input{text/setup}
\input{text/definitions}

% Set the space between paragraphs, with flexible glue.
\setlength{\parskip}{7pt plus2pt minus4pt}
\newcommand{\setparskip}{\setlength{\parskip}{7pt plus2pt minus4pt}}
\AtBeginEnvironment{column}{\setlength{\parskip}{7pt plus2pt minus4pt}}

\graphicspath{{images/}{../images/}}

\newcommand{\mycolorbox}[1]{
  \begin{tcolorbox}[colback=white,colframe=structure]
    #1
  \end{tcolorbox}
}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%% MACROS %%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{rgsMacros}

\renewenvironment{remark}{\textit{\structure{Remark.}}}{}
\newcommand{\mstructure}[1]{{\color{structure} #1}}
% \newcommand{\shortfootcite}[2][1-]{\footnote<#1>{\structure{\Citeauthor{#2}}, \citetitle{#2} (\citeyear{#2}).}}
\newcommand{\shortfootcite}[2][1-]{\footnote<#1>{\citet{#2}.}}
% \newcommand{\shortfootcitetwo}[3][1-]{\footnote<#1>{\structure{\Citeauthor{#2}}, \citetitle{#2} (\citeyear{#2}), \structure{\Citeauthor{#3}}, \citetitle{#3} (\citeyear{#3}).}}
\let\footnoterule\relax % Hide line above footnotes.

\title{\input{text/title}}
\author[Wintz, Sanfelice, and Hespanha]{\input{text/author1_name}\footnotemark[1] \qquad 
        \input{text/author2_name}\footnotemark[1] \qquad 
        \input{text/author3_name}\footnotemark[2]}
% \date{Insert Date}
\institute[UCSC, UCSB]{\footnotemark[1]University of California, Santa Cruz\\
\footnotemark[2]University of California, Santa Barbara}

\newcommand{\calAXdef}{\calA \times \{0\} \times \{0, 1\}}
\newcommand{\itemnote}[1]{\note[item]<.->{#1}}

\begin{document}
\makeatletter

% \begin{frame}{Sandbox Frame}

% \end{frame}

\begin{frame}[plain]
\maketitle
\raisebox{8mm}{
  \includegraphics[height = 8mm]{baskin-logo-banner.pdf}
  } 
  \hfill 
  \raisebox{5mm}{
    \includegraphics[height = 13mm]{HSLlogo.eps}
  }
  \hspace{25pt}
% }
\end{frame}

% \begin{frame}
% \frametitle{Problem Statement}
%   \begin{description}
%     \item[Given] \ 
%     \begin{itemize}
%       \item A continuous-time plant $\dot z = \fp(z,u)$ with $z\in\calZ$ \pause
%       \item Two feedback controllers $\kappa_0$ and $\kappa_1$ \pause
%       \item A compact set $\calA$ \pause
%       \item Lyapunov function $V(z)$ associated with $\kappa_0$ that certifies $\calA$ 
%       is uniformly globally asymptotically stable (\UGAS) with respect to $\dot z =
%       \fp(z, \kappa_0(z))$. \pause
%     \end{itemize}
%     \item[Goal] Design switched feedback control law 
%     $u = \kappa_q(z)$ with $q \in \{0, 1\}$ such that: \pause
%     \begin{itemize}
%         \item The compact set $\calA$ is \UGAS. \pause
%         \item Zeno behavior does not occur. \pause
%         \item The $\kappa_1$ controller is preferred over $\kappa_0$ as much
%         as possible. \pause
%         \item The closed loop system is well-posed. \pause
%     \end{itemize}
%   \end{description}
% % There exist $\alpha_1, \alpha_2 \in \calK_\infty$ 
% % and a continuous positive definite function $\rho$ such that
% % \begin{align*}
% %     \alpha_1(\distA{z}) \leq V(z) &\leq \alpha_2(\distA{z} ), &\forall z \in \calZ \\ 
% %     \ip{\nabla V(z)}{\fp(z, \kappa_0(z))} &\leq -\rho(\distA{z}), &\forall z \in \calZ.
% % \end{align*}
% \end{frame}

% \begin{frame}{Outline}
%   \tableofcontents%[subsectionstyle=hide/hide/hide]
%   \note{The structure of my talk will be as follows: 
%   }
%   \note[item]{
%     I will introduce the problem we set out to solve.}
%   \note[item]{I will describe our solution.}
%   \note[item]{
%     Finally, I will present our theoretical results asserting that our solution works.}
% \end{frame} 

% \section{Introduction} 
\section{Motivation and Problem Setting}

% \begin{frame}
%   if  or
%   has certain topological obstructions,   
%   such as systems with states that live 
%   in certain topological manifolds~(\cite{mayhew_quaternion-based_2011,sanfelice_robust_2006}).
%   Such challenges have motivated the use 
%   of supervisory algorithms that
%   selects between multiple 
%   controllers~(\cite{liberzon_switching_2012,battistelli_supervisory_2012,hespanha_logic-based_1998,hespanha_supervision_1996}).
%   For a system with one controller that renders %TODO: This sentence could be improved.
%   a set-point only locally asymptotically stable, 
%   and another controller that guides
%   the system into the vicinity of the set-point, 
%   a class of supervisors called \emph{uniting controllers}
%   produce global asymptotic stability of the set-point 
%   by selecting the first controller near the set-point 
%   and the second controller away from it
%   (\cite{prieur_uniting_2001,sanfelice_hybrid_2021,teel_uniting_1997}).
%   Similarly, a switching strategy for a family of 
%   Lyapunov-certified controllers to achieve asymptotic stability 
%   is presented in \cite{el-farra_output_2005}.
%   For systems with constraints,
%   supervisors are used to
%   provide a backup controller that guarantees 
%   safety when the primary controller 
%   lacks such a guarantee \cite{seto_simplex_1998}.

% \end{frame}

\begin{frame}[t]{Introduction -- Switched Controllers}
  \onslide<+->{Sometimes, a single continuous controller 
  cannot satisfy design requirements.}
  \note{For many control problems, a single continuous 
  feedback controller 
  cannot satisfy all of the design requirements. \par}

  \onslide<+->{This motivates switching between multiple controllers.}
  
  \onslide<+->{Switching has been used toâ€¦}
  % Existing methods use switching between multiple controllers to
  \begin{itemize}[<+->]
    \item Achieve robust global asymptotic stability 
    % when the system violates Brockett's 
    % conditions (\cite{brockett_asymptotic_1983}) or
    around 
    obstructions.\shortfootcite[.-]{mayhew_quaternion-based_2011,sanfelice_robust_2006}
    \itemnote{
      In particular, switching is necessary to achieve 
      \textbf{robust} global asymptotic stability around certain topologial obstructions
    }
    \item Unite multiple Lyapunov-certified controllers 
    (such as local and global controllers) to 
    achieve global asymptotic 
    stability.\shortfootcite[.-]{prieur_uniting_2001,teel_uniting_1997,el-farra_output_2005}
    \itemnote{
      Switching is also used to unite between multiple 
      Lyapunov-certified controllers to 
      achieve a larger basin of attraction
    }
    \item For systems with constraints, to provide a backup 
    controller that guarantees constraint safety when 
    the primary controller is not provably 
    safe.\shortfootcite[.-]{seto_simplex_1998} 
    \itemnote{
      and, for systems with constraints, switching has been used 
      to ensure constraint safety 
      by using a provably safe controller as a backup for 
      an unsafe primary controller.     
      \bigskip 

      Our current work is \textbf{in the vein of} these last two items
      in that our goal is to achieve 
      global asymptotic stability while switching 
      between two controllers.
      But, in contrast to existing methods, we do not require that both 
      controllers are Lyapunov-certified.
      Instead, we use one controller that is Lyapunov-certified 
      as a backup for an uncertified controller. 
      This allows us exploit nice properties of 
      the uncertified controller while guaranteeing convergence.
    }
  \end{itemize}
\end{frame}


\begin{frame}[t]{Why Use an Uncertified Controller?}
  \pause
  \note{
    This raises the question of why we would want to 
    use an uncertified controller in the first place.
  }
  \onslide<+->{An uncertified controller may have ``better'' properties compared to available certified controllers:}
  \itemnote{
    Often, we have an uncertified controller that 
    has better properties, in some sense, 
    than the available certified controllers.
  }
  \begin{itemize}[<+->]
    \setlength{\itemsep}{5pt}
    \item More energy efficient
    \item Faster convergence
    \item Requires less computation
  \end{itemize}
  \onslide<+->{\structure{Examples:}}
  \begin{itemize}[<+->]
    \item Linear quadratic regulator (LQR) for 
    the linearization of a system with an unknown basin of attraction.
    \itemnote{
      One example is if you linearize a system about the origin 
      and then generate an LQR controller
      for the linearized system. Locally, this controller will be 
      approximately optimal, but globally we expect it to fail. 
      We might not, however, know its basin of attraction.
    }
    \item Model predictive control (MPC) that 
    occasionally fails to compute an update.
    \itemnote{
      Another case where our switching strategy 
      could be advantageous is when 
      computing the control input is computationally expensive, 
      such as an MPC controller. 
      The certified controller acts as a backup
      in case the MPC algorithm fails to compute 
      the next input in time.
    }
    \item Black box controllers (e.g., neural network controllers).
    \itemnote{
      Finally, we might have a controller, 
      such as a neural network controller,
      that performs well in empirical tests, but 
      we lack the knowledge or understanding of 
      how it works that is necessary 
      to construct a Lyapunov certificate.
    }
  \end{itemize}

\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{frame}[t]{Problem Setting}
  \vspace{0pt}
  \note{With that motivation in mind, we'll introduce our problem setting.}
  \begin{columns}
    \begin{column}[T]{0.45\textwidth}
      Consider a continuous-time plant 
      \begin{equation*}
          \dot z = \fp(z,u), \quad 
            z \in \plantstatespace, u \in \plantinputspace.
          \label{eq:plant}
      \end{equation*}
      \onslide<2->{Our goal is to render
      a compact set $\calA \subset \plantstatespace$ 
      globally asymptotically stable (\UGAS).}
      \note<.->{
        Our goal is to render a compact set caligraph-A 
        \deleted{uniformly} globally asymptotically stable.
        % For anybody unfamiliar with the definition of \UGAS, 
        % it is sufficient to think of it as global asymptotic stability, 
        % which means that the state converges to caligraph-A from every initial position.\par
      }
      % \onslide<3->{
      % $$u = \kappa_q(z), \quad q \in Q := \{0, 1\}$$}
      \medskip
      
      \onslide<3->{Given two continuous controllers:}
      \note<.->{
        Suppose we have two continuous controllers. }
      \begin{itemize}
        \onslide<3->{\item[$\kappa_0$:] a
          Lyapunov-certified controller 
          % that renders $\calA$ to be \UGAS
          % for $\dot z = \fp(z, \kappa_0(z))$
        }
        \note[item]<3->{The first, Kappa-zero, 
          is a Lyapunov-certified controller 
          that renders caligraph-A 
          to be \UGAS for the closed-loop system. 
        }
        \onslide<4->{\item[\qcolor{1}{$\kappa_1$:}] any continuous controller }
        \note[item]<4->{
          The second, kappa-one, is any continuous controller.
          Because kappa-one is not expected to have a Lyapunov certificate, 
          we call it \emph{uncertified}.
        }
      \end{itemize}
    \end{column} 
    \begin{column}[T]{0.55\textwidth} 
      % \setparskip
      \makebox[\linewidth][c]{
        \only<1-2| handout:0>{
            \includegraphics[width=0.8\linewidth]{feedback_diagram_no_logic_plant.drawio.png
          }}%
        % \only<3>{\includegraphics[width=1.15\linewidth]{feedback_diagram_no_logic.drawio.pdf}}%
        \only<3| handout:0>{\includegraphics[width=1.15\linewidth]{feedback_diagram_no_logic_kappa0.drawio.pdf}}%
        \only<4| handout:0>{\includegraphics[width=1.15\linewidth]{feedback_diagram_no_logic_kappa1.drawio.pdf}}%
        \only<5>{\includegraphics[width=1.15\linewidth]{feedback_diagram_switching_logic.drawio.pdf}}%
        % \only<7>{\includegraphics[width=1.15\linewidth]{feedback_diagram.pdf}}
      }%
      \only<1-2| handout:0>{%
        \begin{flushright}
          \onslide<2>{\includegraphics[width=0.75\linewidth]{compact_set}}\hspace*{30pt}
        \end{flushright}      
        \vspace{10in}
      }%

      \onslide<5>{%
      % \begin{tcolorbox}[colback=structure!5!white,colframe=structure]
        \vspace{0pt}
        \structure{\large Our contribution:}
        \medskip

        Switching logic 
        for ${q\in\{0,1\}}$ such that
        \begin{itemize}
          \item $\calA$ is \UGAS
          % \item Zeno behavior does not occur, and 
          \item \qcolor{1}{$\kappa_1$} is preferred over \qcolor{0}{$\kappa_0$}
        \note[item]<3->{The first, Kappa-zero, 
          is a Lyapunov-certified controller that renders caligraph-A 
          to be \UGAS for the closed-loop system. 
        }
        \end{itemize}
      % \end{tcolorbox}
      }
      \note[item]<5->{
        The problem to solve consists of designing the switching logic 
        between kappa-zero and one such that 
        the target set is \UGAS and kappa-one is preferred over kappa-zero.
      }
    \end{column}
  \end{columns}
\end{frame}

\begin{frame}[t]{Problem Setting -- Lyapunov-certified Controller $\kappa_0$}
  % A set $\calA$ is called \emph{uniformly globally asymptotically stable} 
  % if for each $r,\varepsilon>0$,
  % \begin{itemize}
  %   \item there is a uniform bound on \structure<1>{the norm} of all trajectories 
  %   that start within a distance $r$ from $\calA$, \pause and  
  %   \item there is a uniform bound on \structure<2>{the time} it 
  %   takes all trajectories that start within a distance $r$ from $\calA$ 
  %   to converge within a distance $\varepsilon$ from $\calA$. \pause
  % \end{itemize}
  % \note{
  % This is the standard definition of \UGAS that 
  % you may be familiar with.
  % }

  % \begin{center}
  %   \vspace{-10pt}
  %   \structure{-----------------------}
  %   \vspace{-10pt}
  % \end{center}

  \vspace{20pt}
  Because $\qcolor{0}{\kappa_0}$ is Lyapunov-certified
  there exists a Lyapunov function 
  $$\mstructure{V : \plantstatespace \to \nnreals}$$
  that guarantees $\calA$ is \UGAS for
  $$\zdot = \fp(z, \qcolor{0}{\kappa_0}(z)).$$
  % if there exist $\alpha_1, \alpha_2 \in \Kinfty$ 
  % and a continuous positive definite function $\rho$ such that
  % \begin{align*}
  %   \alpha_1(\distA{z}) \leq V(z) &\leq \alpha_2(\distA{z} ) &\forall z \in \realsn, \\ 
  %   \ip{\nabla V(z)}{f(z)} &\leq -\rho(\distA{z}) &\forall z \in \realsn.
  % \end{align*}
\end{frame}

\subsection{Example: MPC with Slow Computation}

\begin{frame}{Example: Model Predictive Controller with Slow Computation}
  \newcommand{\fsampled}{{f_{s}}}
  \newcommand{\zsampled}{{z_{s}}}
  \newcommand{\usampled}{{u_{s}}}
  \newcommand{\Tsample}{{T}}
  \newcommand{\Tactual}{{T_{c}}}
  % \bigskip
  \begin{columns}
    \begin{column}[T]{0.5\linewidth}
      \setlength{\parskip}{7pt plus2pt minus4pt}
      Consider a nonlinear plant 
      $$\zdot = \fp(z, u) $$ %\qquad {z, u\in\reals^2},$$
      and two controllers:
      \begin{itemize}
        \onslide<2->{\item[\qcolor{0}{$\kappa_0$}:] Lyapunov-certified controller} %that
        % $$\kappa_0(z) := \half\mat{-1 & 2 \\ -2 & -1}z,$$
        % has the Lyapunov function $V$
        \onslide<3->{\item[\qcolor{1}{$\kappa_1$:}] Model predictive controller (MPC)
        with a sampling period of $1 \msec$}
        % Between updates, zero-order hold generates the control signal.
      \end{itemize}

      % \onslide<4->{
      %   Suppose the time required to 
      %   compute the next MPC input value is~$2\msec$.
      % }
      % \begin{itemize}
        \onslide<4->{ Suppse A new MPC feedback value is 
        not available at every sample time.}

      % \end{itemize}
      % \begin{tcolorbox}[colback=white,colframe=structure]
      %   \centering
      \onslide<6->{\structure{\bf When should we switch?}}
      \note[item]<6->{
        The key question is: when do we switch 
        between the certified and the uncertified controller?
        A naive approach would to use kappa-one whenever 
        it causes $V(z)$ to decrease, 
        but there are two problems with this approach:
        first, it could cause arbitrarily fast switching, so we need 
        hysteresis to prevent chatter and, second, 
        even if $V$ decreases monotonically, it may converge to a non-zero value.
      }
      % \end{tcolorbox}
    \end{column}
    % \hspace{-0.5in}
    \begin{column}[T]{0.5\linewidth}
      \begin{center}
        \newcommand{\myimagewidth}{0.76\linewidth}
        \vspace{-10pt}
        \onslide<2->{%
          \includegraphics[width=\myimagewidth]{mpc_example_kappa0}}
        \vspace{5pt} 
  
        \only<-4| handout:0>{\onslide<3-4| handout:0>{%
          \includegraphics[width=\myimagewidth]{mpc_example_kappa1_until_1sec}}}
        \only<5->{\includegraphics[width=\myimagewidth]{mpc_example_kappa1}}
      \end{center}
    \end{column}
  \end{columns}
\end{frame}
 
\begin{frame}%{Example -- MPC}
  \vspace{10pt}
  \centering
  \includegraphics[width=0.78\linewidth]{mpc_example_switched_4}
  \begin{itemize}
    \item The dynamics of $v$ are described later.
  \end{itemize}

  \note{We introduce an auxiliary state variable little-$v$
  to act as an upper bound on $V$ of $z$ while $q$ is equal to $1$. 
  If $V$ of $z$ does not decrease fast enough, then little-$v$ will 
  catch up, prompting a switch to the certified controller. 
  % If the certified controller later causes 
  The dynamics of little-$v$, which we describe later, 
  are designed such that little-$v$ converges to zero, squeezing $V$ 
  to zero as well. 
  }
\end{frame}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%    
\section{Hybrid Control Strategy}      
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:outline of strategy}

% \begin{frame}{Hybrid Control Strategy -- Closed Loop System}
%   The state of the closed loop system: %% $(z, v, q)$ 
%   % $$x := (z, v, q) \in \calX := \plantstatespace \times \nnreals \times \{0, 1\}$$
%   \begin{description}
%       \item[$z \in \reals^\nplant$:] state of the plant \pause
%       \item[$v \in \nnreals$:] upper bound for $V{(z)}$ when $q=1$ \pause
%       % to restrict how much $V{(z)}$ can grow \pause
%       % before triggering a switch to $q = 0$ \pause
%       % At each switch, $v$ records the value of $V(z)$, 
%       % then $v$ decreases along flows, converging to zero. 
%       \item[$q \in \{0, 1\}$:] determines whether $\kappa_0$ or 
%           $\kappa_1$ is used \pause
%   \end{description}
%   We aim to make the following compact set to be \UGAS: 
%   \begin{equation*}
%       \calAX := \setdef{(z, v, q) \mid z\in \calA, v = 0}. % = \calAXdef.
%   \end{equation*}

%   \vfill
%   \red{[Should I delete or move this slide?]}
% \end{frame}

% \begin{frame}
  % The rate of change of $V{(z)}$
  % is central to our discussion, so for each 
  % $z \in \plantstatespace$ and each $q\in Q$, we define 
  % $$\dot V_{q}(z) := \ip{\del V(z)}{\fp(z, \kappa_{q}(z))}.$$
  % Because $V$ is a Lyapunov function for $\dot z = f_P(z, \kappa_0(z){)}$, 
  % there exists a continuous positive definite function $\rho$ such
  % that $\dot V_0(z) \leq -\rho(|z|_A)$ 
  % for all $z\in \reals^n$.
% \end{frame}

\newcommand{\minipageheight}{6in}
\begin{frame}[t]{Hybrid Control Strategy -- Switching Logic}
  % \only<1>{\begin{center}
  %   Let $\dot V_{q}(z) := \ip{\del V(z)}{\fp(z, \kappa_{q}(z))}, \quad q \in \{0, 1\}.$
  % \end{center}}
  \VonedotDefinition
  \pause

  \begin{minipage}[t][\minipageheight][t]{\linewidth}
  \begin{columns}
    \begin{column}[T]{0.5\textwidth}
      {\large\structure{Threshold functions:}}\smallskip

      \onslide<+->{Let
      ${\sigmazero, \sigmaone : \nonnegativereals \to \nonnegativereals}$ be
      continuous functions such that}
      \begin{itemize}[<+->]
        \item
          $\sigmaone$ is positive definite
        \item 
        $\sigmazero(s) > \sigmaone(s)$ for all $s \geq 0$ 
      \end{itemize}%

      % Note that 
      % $\calZswitchtoone \subset \interior \calZholdone$,
      % $\calZswitchtozero \subset \interior \calZholdzero,$ 
      % $\calZholdzero \union \calZholdone = \reals^\nplant$. 
      % and \calZswitchtozero$ and $\calZswitchtoone$ are closed and disjoint.
    \end{column}
    \begin{column}[T]{0.5\textwidth}
      \vspace{-9pt}
        \begin{center}
          \onslide<2->{\includegraphics[width=\linewidth]{sigmas_slides.pdf}}
        \end{center}
    \end{column}
  \end{columns}
  \end{minipage}
\end{frame}

\newcommand{\calZholdzerodef}{\{z \in \plantstatespace \mid \dot V_1(z) \geq -\sigmazero(\distA{z})\}}
\newcommand{\calZswitchtoonedef}{\{z \in \plantstatespace \mid \dot V_1(z) \leq -\sigmazero(\distA{z})\}}

\begin{frame}[t]{Hybrid Control Strategy -- Switching Logic}
  \VonedotDefinition

  \begin{minipage}[t][\minipageheight][t]{\linewidth}
  \begin{columns}
    \begin{column}[T]{0.5\textwidth}
      {\large\structure{For $q = 0$ (certified controller):}}\smallskip

      $\dot V_1$ is 
      ``small enough to switch to $q=1$''
      if 
      $$\dot V_1(z) \leq -\sigmazero(\distA{z})$$
      \onslide<2->{and $\dot V_1$ is  ``large enough to hold $q=0$'' 
      if 
      $$\dot V_1(z) \geq -\sigmazero(\distA{z}).$$}
      \itemnote{
        This implies that the uncertified controller will 
        push $z$ toward the target set.
      }
    \end{column}
    \begin{column}[T]{0.5\textwidth}
      \vspace{-9pt}
        \begin{center}
          \only<1>{\includegraphics[width=\linewidth]{Z_0mapsto1_slides.pdf}}
          % \includegraphics[width=0.5\linewidth]{Z1.pdf}
          % \includegraphics[width=0.4\linewidth]{holding_regions.pdf}
          \only<2-| handout:0>{\includegraphics[width=\linewidth]{Z0_slides.pdf}}
          % \includegraphics[width=0.5\linewidth]{Z_1mapsto0.pdf}
          % \includegraphics[width=0.4\linewidth]{switching_regions.pdf}
          % \includegraphics[width=\linewidth]{switching_regions.pdf}
         \end{center}
    \end{column}
  \end{columns}
  \end{minipage}
\end{frame}

\begin{frame}[t]{Hybrid Control Strategy -- Switching Logic}
  \VonedotDefinition

  \begin{minipage}[t][\minipageheight][t]{\linewidth}
  \begin{columns}
    \begin{column}[T]{0.50\linewidth}
      
      {\large\qcolor{1}{For $q = 1$ (uncertified controller):}}\smallskip
    
      $\dot V_1$ is 
      ``small enough to hold~$q=1$'' 
      if 
      $$\dot V_1(z) \leq -\sigmaone(\distA{z})$$
      \onslide<2->{and 
      ``large enough to switch to~$q=0$''~if 
      $$\dot V_1(z) \geq -\sigmaone(\distA{z}).$$}
      \onslide<3->{
        \begin{center}
          \vspace{-30pt}
          \structure{--------------------------}
          \vspace{-6pt}
        \end{center}

        A switch to $q=0$ occurs only when both 
        $$\dot V_1(z) \geq -\sigmaone(\distA{z}) \midand
         V(z) \geq v .$$
        %
        % The condition that 
        % is not \textbf{\structure{sufficient}} to switch to~$q=0$.
        \note{For a switch to $q=0$ to occur, we require two conditions:
        Vone-dot must pass above negative sigma-one 
        \emph{and} $V$ of $z$ must have reached little-$v$.\par
        (Because of the design of the dynamics of little-$v$, 
        the switch will always occur when $V(z) = v$, 
        except in some cases when the initial condition satisfies both conditions)
        }
        % \note{The condition that $\dot{V}_1$ 
        % is greater than or equal to negative sigma-one,
        % is necessary but not sufficient for a switch to $q=0$. 
        % We also require that $V$ of $z$ has reached little-$v$.\par}
      }      
      % \begin{itemize}
      %   \item<4> We also require that $V(z) \geq v$ for a switch to occur.
      % \end{itemize}

      % For $q = 1$, we %define
      % \begin{align*}
      %   \calZholdone &:= \calZholdonedef, \\
      %   \onslide<2->{
      %     \calZswitchtozero &:= \calZswitchtozerodef.
      %   }
      % \end{align*}

      % \onslide<3->{
      %   The system jumps when $(z, v, q)$ is in
      %   $$\squeezespaces{0.6}
      %       D_{1} := \{x \in \calX_1 \mid V(z) \geq v\} % \\ &\quad{} 
      %             \intersect \left( \calZswitchtozero\times\nnreals\times\setdef{1} \right)
      %   $$
      % }
      % \onslide<4->{and flows when $(z, v, q)$ is in
      % $$\squeezespaces{0.45}
      %     C_{1} := \{x \in \calX_1 \mid V(z) \leq v\} 
      %          \union \left( \calZholdone \times\nnreals\times\setdef{1} \right)
      % $$
      % where $\calX_1:= \plantstatespace \times \nnreals \times \setdef{1}.$} 
    \end{column}
    \begin{column}[T]{0.5\textwidth}
      % \begin{center}
        % \includegraphics[width=0.5\linewidth]{sigmas.pdf}
        % \includegraphics[width=0.5\linewidth]{Z0.pdf}
        \only<1| handout:0>{\includegraphics[width=\linewidth]{Z1_slides.pdf}}
        % \includegraphics[width=0.4\linewidth]{holding_regions.pdf}
        % \includegraphics[width=0.5\linewidth]{Z_0mapsto1.pdf}
        \only<2->{\includegraphics[width=\linewidth]{Z_1mapsto0_slides.pdf}}
        % \includegraphics[width=0.4\linewidth]{switching_regions.pdf}
        % \includegraphics[width=\linewidth]{switching_regions.pdf}
      % \end{center}
    \end{column}
  \end{columns}
  \end{minipage}
  % Then, the jump set is $D := D_0 \union D_1$ 
  % and the flow set is $C := C_0 \union C_1.$
\end{frame}

\subsection{Example: Switching Logic}

\begin{frame}[t]{Example: Switching Logic}
    \vspace{15pt}
      \begin{columns}
        \begin{column}[T]{0.4\linewidth}
          Consider the plant $$\dot z = u\qquad$$ 
          with $z, u\ {\in}\ \reals$ \onslide<2->{and controllers }
          \begin{align*}
            \onslide<2->{\qcolor0{\kappa_0(z)} &{{} := -z}} \\
            \onslide<3->{\qcolor1{\kappa_1(z)} &{{} := -z^3}} \qquad % qquad fixes alignment.
          \end{align*} 
        \end{column}
        \hspace{-30pt}
        \begin{column}[T]{0.6\linewidth}
          \only<2| handout:0>{\includegraphics[width=\linewidth]{languish_example_comparison_kappa0_slides}}
          \only<3| handout:0>{\includegraphics[width=\linewidth]{languish_example_comparison_kappa1_slides}}
          \only<4>{\includegraphics[width=\linewidth]{languish_example_comparison_slides}}
        \end{column}     
      \end{columns}
      \note{We'll illustrate the switching logic with a simple example. Consider 
      the plant shown. Let $\kappa_0$ be a linear feedback and let $\kappa_1$ be cubic. 
      In this case, both controllers cause $V(z)$ to converge to zero, 
      but we can see that $\kappa_1$ is faster far from the origin whereas 
      $\kappa_0$ is faster near the origin. 
      Our switching logic uses $\kappa_1$ far from the origin and switches 
      when the convergence slows down. 
      
      }
\end{frame}

\begin{frame}
  \vspace{10pt}
  \begin{center}
    \includegraphics[width=0.78\linewidth]{languish_example_slides}
  \end{center}
  \note{In these plots, we can see the details of why the switch occurs where it does.}
\end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
        %\subsection{Closed-Loop System}        
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 
\label{sec:construction of system}

\begin{frame}{Dynamics of Closed-Loop System}
  \pause
  \structure{At each switch:} 
  \begin{itemize}
    \item $z$ is unchanged \pause
    \item $q$ is toggled to the opposite value in $\setdef{0, 1}$ \pause
    \item $v$ is set to $V(z)$ \pause % to record $V$'s value
    \itemnote{Little-$v$ records the value of $V$ of $z$.}
  \end{itemize}
  \structure{Between switches:}
  \begin{itemize}[<+->]
    \item $z$ evolves according to $\dot z = \fp(z, \kappa_q(z))$  
    \itemnote{The state plant evolves according to the plant dynamics.}
    \item $q$ is constant
    \itemnote{The logic variable $q$ is constant.}
    \item $v$ evolves according to the dynamics chosen here: 
    \begin{equation*}
        \dot v 
        % = \fv(z, v, q)
        = 
        \begin{cases}
                                                     \onslide<+->{ {-}v,} & \onslide<.->{\qcolor0{\textif q = 0 \text{ (certified)} } ,} \\
            \onslide<+->{{-}\sigmaone(\distA{z}) + \vdiffcoeff(V(z) - v),} & \onslide<.->{\qcolor1{\textif q = 1 \text{ (uncertified) } },} 
        \end{cases}
    \end{equation*}
    \onslide<.->{where $\mu > 0$ is parameter.}
  \end{itemize} 

  % \item The parameter $\mu$ determines how closely $v$ follows $V(z)$.
  \itemnote{
    You can see that this term [point to ``$v(V(z) - z)$''] pulls
    little-$v$ towards $V(z)$. 
    Increasing the parameter $\mu$ increases the strength of the attraction.
  }
\end{frame}

\begin{frame}[t]{Hybrid Control Strategy --- Design of $v$'s Dynamics}
  \onslide<+->{\begin{equation*}
    \dot v =
    \begin{cases}
                                                {-}v, & \qcolor0{\textif q = 0 \text{ (certified)} } , \\
        {-}\sigmaone(\distA{z}) + \vdiffcoeff(V(z) - v), & \qcolor1{\textif q = 1 \text{ (uncertified)} }. 
    \end{cases}
  \end{equation*} }
  \begin{itemize}[<+->]
    \setlength{\itemsep}{10pt}%

    \item With our switching logic, $v$ converges to $0$. 
    % \item%[(R2)]
    % If $V(z) \leq v \neq 0,$ then 
    % $\fv(z, v, 1) < 0$ and $v$ converges toward zero. \pause

    \item%[(R5)] 
    % After a switch to $q=1$ (where $v$ is set to $V(z)$),
    % then $v$ must initially decrease slower than $V$. In particular, 
    % After 
    % $z\in \calZswitchtoone := \calZswitchtoonedef$, \pause
    After every switch from $\qcolor0{q=0}$ to $\qcolor1{q=1}$, there is
    an interval where no switches can occur because $V(z) < v$.

    % \item $\max\{V(z), v\}$ is always decreasing (unless already zero).

    \item%[(R4)] 
    While $\qcolor1{q=1}$, if $V(z)$ does not converge fast enough %to hold $q=1$,
    % $z \in \calZswitchtozero := \calZswitchtozerodef$, \pause
    then $v$ will catch up to $V(z)$, causing a switch to $\qcolor0{q=0}$. 
    \itemnote{
      This acts as a fail-safe in case $V{(z)}$ 
      otherwise fails to converge to zero.
    }

  \end{itemize}

  %   If $V(z) > v,$ then $v$ is allowed to increase because,
  %   eventually, one of the following must occur:
  %   \begin{itemize}
  %       \item $z$ enters $\calZswitchtozero$ 
  %       prompting a switch to $q=0$;
  %       \item $V(z) = v,$ in which case \ref{rule:Ax achieved} or
  %       \item $z \in \calZholdone$ and $V(z) > v$ hold for the rest of time,
  %       so $V{(z)}$ converges to $0$ and $v$ is squeezed to $0$ as well.
  % \end{itemize}
\end{frame}

% \begin{frame}
%   The behavior of $v$ while $V(z) \leq v \neq 0$ is 
%   crucial to the performance of the closed-loop system.
%   We prescribe the following cases:
%   \begin{enumerate}
      
%   \end{enumerate}%
%   % }%
% \end{frame}

% \begin{frame}
  % To satisfy the above conditions,
  % we define $\fv$ at each $(z, v, 1)$ as
  % \begin{equation}
  %     \fv(z, v, 1) = -\sigmaone(\distA{z}) + \vdiffcoeff(V(z) - v)
  %     \label{eq:fv q = 1}
  % \end{equation}
  % with $\vdiffcoeff > 0$.
  % The term $\vdiffcoeff(V(z) - v)$ pushes $v$ toward $V{(z)}$ 
  % at a rate proportional to the difference $V(z) - v$, 
  % which helps $v$ to ``catch up'' if $V{(z)}$ has dropped quickly.
  
  % Combining the cases for $q=0, 1$, the dynamics of $v$ are 
  % \begin{equation}
  %     \dot v 
  %     = \fv(z, v, q)
  %     := 
  %     \begin{cases}
  %                                                   -v, & \textif q = 0, \\
  %         -\sigmaone(\distA{z}) + \vdiffcoeff(V(z) - v), & \textif q = 1.
  %     \end{cases}
  %     \label{eq:vdot}
  % \end{equation}
  % The system parameters $\sigmaone$ and $\vdiffcoeff$ 
  % affect the rate at which $v$ converges toward zero while $q=1$.
  % Larger choices of $\sigmaone$ and $\vdiffcoeff$ cause $v$ to decay faster, 
  % which reduces the amount $V{(z)}$ can increase before switching back to $q=0$, 
  % whereas smaller choices of $\sigmaone$ and $\vdiffcoeff$ 
  % correspond with a stronger preference for $\kappa_1$.
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%     \subsection{System Specification}            
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\subsection{Example: LQR of Linearized System}

\begin{frame}{Example: Linear Quadratic Regulator of Linearized System}
Consider the nonlinear plant
\begin{equation*}
  \zdot = A z + u + \underbrace{f(z, u) }_{\substack{\text{Nonlinear}\\\text{component}}}
  % \zdot = A_1 z + \min(\norm{z}, 1) A_2 z + u
  \qquad z, u \in \reals^2.
\end{equation*}%
% $$A_1 := \mat{4 & 2 \\ -2 & 0}, \midand  A_2 := \mat{0 & 4 \\ -2 & 1}.$$ \pause
\note{%
  Consider the plant dynamics shown here. 
  % This system behaves like $\zdot = A_1z$ near the origin and 
  % like $\zdot = (A_1+A_2)z$ far~from~it.
  \par
}\pause%
Let
% $$\kappa_0(z) := \mat{-5 & 0 \\ 0 & -5}z.$$ \pausex
$\qcolor0{\kappa_0}(z) := Kz$
be a high-gain Lyapunov-certified controller.
\note{
   Suppose the origin is \UGAS for the proportional feedback shown here.
  \par
}
\pause

Let $\qcolor1{\kappa_1}$ be the LQR feedback 
that solves the following LQR problem:
\begin{equation*}
    \begin{aligned}
        \minimize{u} & \int_0^\infty \norm{z(t)}^2 + \norm{u(t)}^2 \dt \\
        \subjectto & \zdot = Az + u.
    \end{aligned}
    \label{eq:lqr problem}
\end{equation*}
\note{
  For the uncertified controller, we use the LQR feedback generated by 
  linearizing the system about the origin [point to constraint]. 
}
\end{frame}

\begin{frame}{Example: LQR of Linearized System}
  \vspace{10pt}
  \begin{center}
      \includegraphics[height=2.9in]{lqr_example_1_slides} 
      \pause
      \includegraphics[height=2.9in]{lqr_example_16_slides}
  \end{center}
  \note{
    Here are plots for a solution starting with $q=0$. We see that 
    $V$-one dot is initially below the \deleted{negative} sigma zero threshold, 
    triggering a switch to $q = 1$. As the system evolves, 
    $V$-one dot briefly moves above the \deleted{negative} sigma one threshold,
    but a switch does not occur because little-$v$ remains greater than $V$ of $z$.

    Alternatively, if we increase the parameter $\mu$ to $16$, then 
    little-$v$ follows $V$ of $z$ more closely, so while $V$-one dot 
    is above the sigma-one threshold, little-$v$ catches up with $V$ of $z$, 
    triggering a switch to $q=0$. The system briefly uses the certified controller until 
    $V$-one dot decreases below the sigma-zero threshold, causing a switch back 
    to the uncertified controller, which is used thereafter. 

    While $q$ is equal to $0$, the state converges faster, 
    but this comes at the cost of higher control effort.
  }
\end{frame}

\begin{frame}
  \frametitle{Example: LQR of Linearized System}

  % \mycolorbox{
  For $\qcolor{1}{\kappa_1}$, 
  we could, instead, use 
  \begin{itemize}
    \item MPC
    \item Machine learning
    \item Untested prototypes
  \end{itemize}
  without compromising our convergence guarantee.
  % }
  \itemnote{
    We are using LQR to keep the example simple, 
    but you could just as well use MPC, machine learning
    or a untested prototype created by your boss's son, 
    all without compromising your convergence guarantee.
  }

\end{frame}


% \begin{frame}{Closed-Loop System}
%   The construction above leads a hybrid closed-loop system: 
%   \begin{equation*} 
%       \calH: \begin{cases}
%       \xdot = f(x) := \mat{\fp(z, \kappa_q(z)) \\ \fv(z, v, q) \\ 0}
%               & \forall x \in C := C_0 \cup C_1 \\ 
%       x^+ = g(x) := \mat{z \\ V(z) \\ 1 - q} & \forall x\in D := D_0 \cup D_1
%   \end{cases}
%   \end{equation*}
%   where \begin{align*}
%     C_0 &:= \setdef{(z, v, 0) \in \calX \suchthat V(z) \text{ is large enough to hold $q=0$}}, \\
%     C_1 &:= \setdef{(z, v, 1) \in \calX \suchthat V(z) \text{ is small enough to hold $q=1$}}, \\
%     D_0 &:= \setdef{(z, v, 0) \in \calX \suchthat V(z) \text{ is small enough to switch to $q=1$}}, \\
%     D_1 &:= \setdef{(z, v, 1) \in \calX \suchthat V(z) \text{ is large enough to switch to $q=0$}}.
%   \end{align*}
% \end{frame}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Main Result: The Target Set $\calA$ is Globally Asymptotically Stable}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\label{sec:analysis}

\begin{frame}[t]{Main Result: Global Asymptotic Stability}
  % \vspace{15pt}
  \note{
    Now that we have seen several examples, 
    let's look at our theoretical results. \par
  }
  \begin{theorem}
      Suppose that  
      \begin{itemize}[<+->]
        \item $\fp,$ $\kappa_0,$ and $\kappa_1$ are continuous;
        \item $V$ is continuously differentiable.
    \end{itemize} 
    \onslide<+->{
      Then, $\calAX := \setdef{(z, v, q) \mid z\in \calA, v = 0}$ 
      is \UGAS for the closed-loop system.
    } % Deleted: ":= \calAXdef"
    
    \label{the:UGAS}
  \end{theorem}
  \note<.->{
    Suppose the plant dynamics and the controllers are continuous 
    and the Lyapunov function is continuously differentiable. Then, 
    the target set is \UGAS for the closed-loop system we described above.
  }
  \vspace{-8pt}

  \onslide<+->{\proofsketch
  Let
  \begin{equation*}
      \tV(z, v, q) := \max\{V(z), v\}
  \end{equation*}}%
  \onslide<+->{We show that $\tV$ is a Lyapunov function for the closed-loop system.} 
  \itemnote{We show that $V$-twiddle is a nonsmooth Lyapunov function}
  % which is positive definite relative to $\calAX$.\pause
  
\begin{itemize}[<+->]
  \item Outside $\calAX$, $\tV{(z, v, q)}$ 
    decreases along flows.
  % \item Outside $\calAX$, when $(z, v, q)$ evolves between switches, 
  % $\tV{(z, v, q)}$ decreases.
  % \item Inside $\calAX$, $\tV{(x)}$ is constant
    % \begin{itemize}[<+->]
    %   \item if $q = 0,$ then both $V{(z)}$ and $v$ are decreasing; \pause
    %   \note[item]{while using the certified controller, both $V$ of $z$ and little-$v$ 
    %   are decreasing.}
    %   \item if $q = 1$, then whichever is larger of $V(z)$ or $v$ is decreasing. 
    %   \note[item]{while using the uncertified controller, 
    %   then the larger of the two values is decreasing.}
    %   \pause 
    % \end{itemize}
    \item At each switch, $\tV{(z, v, q)}$ does not increase.
    \item The time between switches is nonzero.
\end{itemize}

  \onslide<+->{Therefore, $\calAX$ is \UGAS.  \qed}
  \nocite{sanfelice_invariance_2007}
  \nocite{sanfelice_hybrid_2021}


  \onslide<+->{\begin{remark}
    The asymptotic stability of $\calAX$ is robust to small perturbations.
  \end{remark}}
\end{frame}

% \begin{frame}
%   To show that $\tV(x):= \max\{V(z), v\}$ is decreasing when $q=1$, let 
%   $$\tVc(x, f(x))$$ be 
%   the Clarke generalized directional derivative \nocite{clarke_optimization_1990}
%   of $\tV$ at $x \in \calX$ in the direction~$f(x)$. \pause

%   Let  
%   $\calB := \{{x \in \calX} \mid {q=1}, 
%           V(z) = v \AND \dot V_1(z) > -\sigma_1(\distA{z})\}.$ \pause
%   % \vspace{-20pt}
%   \begin{itemize}
%     \setlength{\itemsep}{10pt}%
%     \item For each $x \in C \setminus (\calB \union \calAX)$,
%     $\tVc(x, f(x)) < 0.$\pause 
%     \item For each $x \in \calB$, $f(x)$ points out of $C$. \pause
%   \end{itemize}
%   Thus, $\tV{(x)}$ decreases along flows in $C \setminus \calAX$. \pause
%   \begin{itemize}
%     \item For each $x \in \calAX$, $\tVc(x, f(x)) = 0.$ \pause
%   \end{itemize}

%   The time between jumps is lower bounded by a positive constant
%   and $\tV{(x)}$ does not increase at jumps. \pause

%   Therefore, $\tV$ is a (nonsmooth) Lyapunov function for $\calH$, and
%   $\calAX$ is \UGAS.
%   \nocite{sanfelice_invariance_2007}
%   \nocite{sanfelice_hybrid_2021}
%   \qed
%   % Mention robustness 

% \end{frame}

\section{Conclusion}

\begin{frame}{Conclusion}
  \structure{Summary}
  
  \begin{itemize}[<+->]
    \item Lyapunov-certified 
      controller acts as a backup to ensure convergence 
      while using an uncertified controller.
    \itemnote{Our hybrid control strategy uses a Lyapunov-certified controller as a 
    backup to ensure convergence while using an uncertified controller.
    }
    \item Exploit useful properties of \structure{\textbf{any}} 
    uncertified continuous controller without losing the convergence guarantee.
    \itemnote{As we have illustrated in examples, 
      our switching logic allows us to exploit nice properties of 
      uncertified controllers without losing the guarantee that the target set is \UGAS.}

    % \item 
  \end{itemize}

  \onslide<+->{\structure{Future work}}
  \begin{itemize}[<+->]
    \item Weaken assumptions on $\kappa_1$ and $V$.
    \itemnote{We are working on weaken the assumptions required for our 
    strategy by allowing the Lyapunov function to be nonsmooth and the 
    uncertified controller to be discontinuous.} 
    \item Consider systems with disturbances.
    \item Adapt hybrid control strategy for systems with constraints.
    \itemnote{It is worth noting that we have preliminary results 
    for a strategy that parallels the one presented today but applied to 
    constraint safety via barrier functions.}
    %  by switching between 
    % a primary controller that is not provably safe 
    % and a backup controller with safety guarantees
    % to create a hybrid closed-loop system 
    % that is provably safe and convergent.
  \end{itemize}


  % We envision
  % that our switching logic could be particularly useful % "We envision.." per Ricardo
  % for reinforcement learning control,
  % which demonstrates good results empirically, 
  % but for which it is often difficult to produce Lyapunov 
  % certificates.
\end{frame}

\begin{frame}
  \vspace{0.4in}
  \begin{center}
    % \only<0| handout:1>{
      \Huge
      \structure{Questions?}
    % }
    % \only<1| handout:0>{
    %   \animategraphics[autoplay,width=0.8\linewidth]{30}{animation/QuestionsScene}{0000}{0052}
    % }
  \end{center}
\end{frame}

\newcommand{\fundingsource}[2]{\item \structure{#1} \par \hspace{15pt} {\footnotesize #2}}
\begin{frame}
  \frametitle{Funding Acknowledgements}
  \vspace{20pt}
  This research was supported by
  \begin{itemize}
    \fundingsource{The National Science Foundation}{Grant nos.\ ECS-1710621, CNS-1544396, and CNS-2039054}
    \fundingsource{The Air Force Office of Scientific Research}{Grant nos.\ FA9550-19-1-0053, FA9550-19-1-0169, 
    and FA9550-20-1-0238}
    \fundingsource{The Army Research Office}{Grant no.\ W911NF-20-1-0253}
    \fundingsource{The U.S. Office of Naval Research}{MURI grant no.\  N00014-16-1-2710}
  \end{itemize}
  \vspace{0.8in}
  Please direct correspondence to Paul Wintz at \texttt{pwintz@ucsc.edu}.

\end{frame}

% \setbeamertemplate{bibliography item}{}
% \begin{frame}[allowframebreaks]{References}
%   %%% BIBLIOGRAPHY
%   \printbibliography
% \end{frame}

\appendix


\begin{frame}{Definition of UGAS}
  \begin{definition}%[Uniform global stability, pre-attractivity, and pre-asymptotic stability]%[{\cite[Definition 3.7]{sanfelice_hybrid_2021}}]
    A nonempty set \(\calA \subset \realsn\) is said to be
    \begin{itemize}
      \item \emph{uniformly globally stable} if there exists 
      a continuous, strictly increasing function \(\alpha\) 
      such that every solution \(x\) to \(\calH\) satisfies 
      \(\distA{x(t, j)} \leq \alpha\left(\distA{x(0,0)}\right)\) 
      for each \((t, j) \in \dom x\); and
      \item
      \emph{uniformly globally attractive} for \(\calH\) if 
      every maximal solution is complete and
      for all \(\varepsilon>0\) and \(r>0\), there exists \(T>0\) such that
      every solution \(x\) to \(\calH\) with \(|x(0,0)|_{\calA} \leq r\)
      satisfies $|x(t, j)|_{\calA} \leq \varepsilon$ for all $(t, j) \in \dom x$
      such that $t+j \geq T$. 
      \item
      If $\calA$ is 
      both uniformly globally stable and uniformly globally attractive for $\calH$,
      then it is said to be
      \emph{uniformly globally asymptotically stable} (UGAS) for \(\calH\).
    \end{itemize}
    % uniformly globally stable and uniformly globally attractive.
\end{definition} 
\end{frame}

\begin{frame}


  \vspace{20pt}
  Because $\qcolor{0}{\kappa_0}$ is Lyapunov-certified
  there exists a Lyapunov function 
  $$\mstructure{V : \plantstatespace \to \nnreals}$$
  that guarantees $\calA$ is UGAS for
  $$\zdot = \fp(z, \qcolor{0}{\kappa_0}(z)).$$

  Namely, there exist $\alpha_1, \alpha_2 \in \Kinfty$ 
  and a continuous positive definite function $\rho$ such that
  \begin{align*}
    \alpha_1(\distA{z}) \leq V(z) &\leq \alpha_2(\distA{z} ) &\forall z \in \realsn, \\ 
    \dot V_0(z) &\leq -\rho(\distA{z}) &\forall z \in \realsn.
  \end{align*}
  

\end{frame}

% \subsection{Hybrid Systems}
% Hybrid System
\begin{frame}[t]{Hybrid Systems}
  We consider hybrid systems modeled as \nocite{goebel_hybrid_2012,sanfelice_hybrid_2021}
  \begin{equation*}
      \calH \left\{\begin{aligned}
          \mstructure{\xdot \hspace{4pt}}&\mstructure{= f(x)} & \mstructure{x \in C} \\
          \darkred{x^+} &= \darkred{g(x)} & \darkred{x \in D}
      \end{aligned}\right. 
      \label{eq:hybrid system}
  \end{equation*} %\pause
  with 
  \begin{multicols}{2}
  \begin{itemize}
    % \renewcommand{\emph}[1]{#1}
    \item \structure{flow set $C \subset \realsn$} %\pause
    \item \structure{flow map $f : {C} \to \realsn$} %\pause
    \item[\darkred{$\blacktriangleright$}] \darkred{jump set $D \subset \realsn$} %\pause
    \item[\darkred{$\blacktriangleright$}] \darkred{jump map $g : {D} \to \realsn$} %\pause
  \end{itemize}
\end{multicols}
\medskip

% \begin{multicols*}{2}
%   A solution $x$ to $\calH$ 
%   is defined on a \emph{hybrid time domain} 
%   $\dom x \subset \nnreals \times \naturals.$ 

%   \includegraphics{hybrid_time_domain}
% \end{multicols*}

% \note{  
 
  % A solution $x$ is said to be \emph{complete} if $\dom x$ is unbounded, 
  % and is said to be \emph{Zeno} if it is complete 
  % and the $t$ component of $\dom x$ is bounded 
  % (implying $j \to \infty$ in finite ordinary time). 
  % A solution $x$ is said to be \emph{maximal} if there does not exist a solution $y$
  % to $\calH$ such that $x$ is a truncation of $y$ to a strict subset of $\dom y.$   
% }
\end{frame}

\begin{frame}[t]{Clarke Generalized Gradient}
  For the function $$\tV(x) := \max\{V(z), v\},$$
  the Clarke generalized gradient at $x = (z, v, q)$ in the direction $w = (w_z, w_v, 0)$ is
  \begin{equation}
    \tVc(x, \flowdir)
    = \begin{cases}
                                \ip{\nabla_z V(z)}{\flowdir_z} & \textif V(z) > v, \\
        \max\setdef{\ip{\nabla_z V(z)}{\flowdir_z}, \flowdir_v} & \textif V(z) = v, \\
                                                    \flowdir_v & \textif V(z) < v.
    \end{cases}
  \end{equation}
\end{frame}



\end{document}